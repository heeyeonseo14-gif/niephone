<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>niephone 主屏幕</title>

<style>
body{
  margin:0;
  background:#000;
  font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  color:white;
}

/* 手机外框 */
.phone{
  width:360px;
  height:780px;
  margin:20px auto;
  border-radius:22px;
  overflow:hidden;
  background:black;
  position:relative;
}

/* 壁纸 */
.wallpaper{
  position:absolute;
  inset:0;
  background-size:cover;
  background-position:center;
  z-index:1;
}

.overlay{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,0.25);
  z-index:2;
}

/* 内容层 */
.content{
  position:relative;
  z-index:3;
  padding:20px;
  box-sizing:border-box;
  text-align:center;
}

/* 图标区域 */
.grid{
  margin-top:20px;
  display:grid;
  grid-template-columns:repeat(3, 1fr);
  grid-row-gap:35px;
  grid-column-gap:10px;
}

/* 图标外框 */
.icon-box{
  width:90px;
  height:90px;
  margin:auto;
  border-radius:20px;
  background:rgba(255,255,255,0.12);
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  cursor:pointer;
  backdrop-filter:blur(5px);
}

/* 图标图片 */
.icon-box img{
  width:100%;
  height:100%;
  object-fit:cover;
}

/* 图标文字 */
.icon-text{
  margin-top:6px;
  font-size:16px;
}

/* 底部说明 */
.footer{
  position:absolute;
  bottom:20px;
  left:0;
  width:100%;
  text-align:center;
  color:white;
  font-size:15px;
}
</style>
</head>

<body>
<div class="phone">

  <div class="wallpaper" id="wall"></div>
  <div class="overlay"></div>

  <div class="content">

    <div class="grid">
      <!-- 聊天 -->
      <div>
        <div class="icon-box" data-key="icon_chat"><img id="img_chat"></div>
        <div class="icon-text">聊天</div>
      </div>

      <!-- API 设置 -->
      <div>
        <div class="icon-box" data-key="icon_api"><img id="img_api"></div>
        <div class="icon-text">API 设置</div>
      </div>

      <!-- 外观设置 -->
      <div>
        <div class="icon-box" data-key="icon_style"><img id="img_style"></div>
        <div class="icon-text">外观设置</div>
      </div>

      <!-- 人设设置 -->
      <div>
        <div class="icon-box" data-key="icon_role"><img id="img_role"></div>
        <div class="icon-text">人设设置</div>
      </div>

      <!-- 记忆管理 -->
      <div>
        <div class="icon-box" data-key="icon_memory"><img id="img_memory"></div>
        <div class="icon-text">记忆管理</div>
      </div>

      <!-- 更多 -->
      <div>
        <div class="icon-box" data-key="icon_more"><img id="img_more"></div>
        <div class="icon-text">更多</div>
      </div>
    </div>

    <div class="footer">
      niephone<br>
      长按图标可编辑；长按空白更换壁纸
    </div>

  </div>
</div>
<script>
// 默认图标（如果用户还没设置就用这个）
const defaultIcons = {
  icon_chat: "https://i.imgur.com/YYxZqRN.png",
  icon_api: "https://i.imgur.com/YYxZqRN.png",
  icon_style: "https://i.imgur.com/YYxZqRN.png",
  icon_role: "https://i.imgur.com/YYxZqRN.png",
  icon_memory: "https://i.imgur.com/YYxZqRN.png",
  icon_more: "https://i.imgur.com/YYxZqRN.png"
};

// 读取图标
function loadIcons() {
  for (let key in defaultIcons) {
    let img = document.getElementById("img_" + key.replace("icon_", ""));
    let saved = localStorage.getItem(key);
    img.src = saved || defaultIcons[key];
  }
}
loadIcons();

// 长按图标进入编辑
let pressTimer;

document.querySelectorAll(".icon-box").forEach(box => {
  box.addEventListener("touchstart", e => {
    pressTimer = setTimeout(() => editIcon(box.dataset.key), 500);
  });
  box.addEventListener("touchend", e => clearTimeout(pressTimer));
  box.addEventListener("mousedown", e => {
    pressTimer = setTimeout(() => editIcon(box.dataset.key), 500);
  });
  box.addEventListener("mouseup", e => clearTimeout(pressTimer));
});

// 编辑图标：弹窗选择 URL / 本地图片
function editIcon(key) {
  let choice = prompt("输入图片 URL\n（留空则选择本地图片）");
  if (choice) {
    localStorage.setItem(key, choice);
    loadIcons();
  } else {
    // 本地图片选择
    let input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";
    input.onchange = function (e) {
      let file = e.target.files[0];
      let reader = new FileReader();
      reader.onload = function (r) {
        localStorage.setItem(key, r.target.result);
        loadIcons();
      };
      reader.readAsDataURL(file);
    };
    input.click();
  }
}
</script>
<div class="wallpaper-tip">
    长按空白处更换壁纸
</div>
<script>
// ---- 默认壁纸 ----
const defaultWallpaper = "https://i.imgur.com/Pt0hG9l.jpeg";

// ---- 加载壁纸 ----
function loadWallpaper() {
  const saved = localStorage.getItem("wallpaper");
  document.body.style.backgroundImage = `url('${saved || defaultWallpaper}')`;
  document.body.style.backgroundSize = "cover";
  document.body.style.backgroundPosition = "center";
}
loadWallpaper();


// ---- 长按空白处换壁纸 ----
let wallpaperTimer;

document.body.addEventListener("touchstart", e => {
  // 只有点在空白区才触发，不在图标上
  if (e.target.classList.contains("icon-box")) return;
  wallpaperTimer = setTimeout(changeWallpaper, 600);
});
document.body.addEventListener("touchend", e => clearTimeout(wallpaperTimer));

document.body.addEventListener("mousedown", e => {
  if (e.target.classList.contains("icon-box")) return;
  wallpaperTimer = setTimeout(changeWallpaper, 600);
});
document.body.addEventListener("mouseup", e => clearTimeout(wallpaperTimer));


// ---- 壁纸更换函数（URL 或 本地图片）----
function changeWallpaper() {
  let url = prompt("输入壁纸 URL\n（留空则选择本地图片）");

  if (url) {
    localStorage.setItem("wallpaper", url);
    loadWallpaper();
  } else {
    let input = document.createElement("input");
    input.type = "file";
    input.accept = "image/*";

    input.onchange = function (e) {
      let file = e.target.files[0];
      let reader = new FileReader();

      reader.onload = function (r) {
        localStorage.setItem("wallpaper", r.target.result);
        loadWallpaper();
      };

      reader.readAsDataURL(file);
    };

    input.click();
  }
}
</script>
